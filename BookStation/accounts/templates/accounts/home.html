{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Book Store</title>
  <link rel="stylesheet" href="{% static 'css/home/style.css' %}" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700" />
</head>
<body>
  <header>
    <div class="navbar">
      <div class="logo">📚 BookStore</div>

      <input type="text" placeholder="Bạn đang tìm gì?" class="search-box" />

      <div class="icons" style="position: relative;">
  <div id="user-area" style="display: inline-block; position: relative;">
    <a href="{% url 'edit_profile' %}" id="user-icon" style="font-size: 24px; user-select: none; text-decoration: none;">👤</a>

    {% comment %} {% if not user.is_authenticated %}
      <div id="user-popup" class="user-popup" style="position: absolute; top: 36px; right: 0; width: 140px;">
        <a href="{% url 'login' %}"><button class="login">Đăng nhập</button></a>
        <a href="{% url 'register' %}"><button class="register">Đăng ký</button></a>
      </div>
    {% endif %} {% endcomment %}
  </div>

  {% if user.is_authenticated %}
    <div class="auth-buttons" style="display:inline-block; margin-left: 10px;">
      <form action="{% url 'logout' %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button type="submit" class="login">Đăng xuất</button>
      </form>
      <a href="{% url 'profile' %}">
        <button type="button" class="register">Trang cá nhân</button>
      </a>
    </div>
  {% else %}
    <!-- Nút đăng nhập đăng ký mặc định hiện trên thanh navbar (có thể ẩn nếu muốn chỉ hiện popup) -->
    <div class="auth-buttons" style="display:inline-block; margin-left: 10px;">
      <a href="{% url 'login' %}"><button class="login">Đăng nhập</button></a>
      <a href="{% url 'register' %}"><button class="register">Đăng ký</button></a>
    </div>
  {% endif %}

  <span style="margin-left: 10px;">❤️</span>

  <form action="{% url 'view_cart' %}" method="get" style="display:inline; margin-left: 10px;">
    <button type="submit" class="cart-button">🛒 Giỏ hàng</button>
  </form>
</div>

    </div>
  </header>

  <section class="banner">
    <div class="text">
      <h2>Sách mới phát hành</h2>
      <p>Khám phá các đầu sách nổi bật vừa cập nhật!</p>
      <button>Subscribe</button>
    </div>
    <img src="banner-book.png" alt="Banner sách" />
  </section>

  <section class="section">
    <h3>📚 Sách trong cửa hàng</h3>
    <div class="book-list">
      {% for book in books %}
      <div class="book">
        <img src="{{ book.image_url }}" alt="{{ book.title }}" />
        <h4>{{ book.title }}</h4>
        <p>${{ book.price }}
          {% if book.old_price %}
          <span class="old-price">${{ book.old_price }}</span>
          {% endif %}
        </p>
        <form action="{% url 'add_to_cart' book.id %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button type="submit" class="add_button">Thêm vào giỏ hàng</button>
        </form>
      </div>
      {% endfor %}
    </div>
  </section>

  <footer>
    <p>&copy; 2025 BookStore. All rights reserved.</p>
  </footer>
  <script src ="{% static 'home/script.js' %}"></script>
</body>
</html>
