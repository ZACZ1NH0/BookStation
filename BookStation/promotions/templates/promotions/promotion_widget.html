<!-- Promotion Code Widget -->
<div class="promotion-widget">
    <div class="card">
        <div class="card-header">
            <h6 class="mb-0">
                <i class="fas fa-tags text-warning"></i>
                Mã khuyến mãi
            </h6>
        </div>
        <div class="card-body">
            <!-- Messages container -->
            <div id="promotion-messages"></div>
            
            <!-- Applied promotion details -->
            <div id="applied-promotion-details" style="display: none;"></div>
            
            <!-- Promotion code input -->
            <div class="input-group mb-3">
                <input type="text" 
                       id="promotion-code" 
                       class="form-control" 
                       placeholder="Nhập mã khuyến mãi"
                       autocomplete="off">
                <button type="button" 
                        id="apply-promotion-btn" 
                        class="btn btn-outline-primary">
                    <i class="fas fa-tags"></i>
                    Áp dụng
                </button>
            </div>
            
            <!-- Valid promotions list -->
            <div id="valid-promotions-list"></div>
        </div>
    </div>
</div>

<!-- Order Summary Update Template -->
<script id="order-summary-template" type="text/template">
    <div class="order-summary">
        <div class="d-flex justify-content-between mb-2">
            <span>Tạm tính:</span>
            <span id="order-subtotal">{{subtotal}}</span>
        </div>
        
        <div class="d-flex justify-content-between mb-2" id="discount-row" style="display: none;">
            <span class="text-success">
                <i class="fas fa-tags"></i>
                Khuyến mãi:
            </span>
            <span id="order-discount" class="text-success"></span>
        </div>
        
        <hr>
        
        <div class="d-flex justify-content-between">
            <strong>Tổng cộng:</strong>
            <strong id="order-total" class="text-primary">{{total}}</strong>
        </div>
    </div>
</script>

<style>
.promotion-widget .card {
    border: 1px solid #dee2e6;
}

.promotion-widget .card-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #dee2e6;
}

.promotion-item {
    transition: all 0.2s ease;
}

.promotion-item:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.quick-apply-promotion {
    transition: all 0.2s ease;
}

.quick-apply-promotion:hover {
    transform: scale(1.05);
}

#promotion-code {
    text-transform: uppercase;
}

#promotion-code:focus {
    border-color: #80bdff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

.alert {
    margin-bottom: 1rem;
    animation: slideInDown 0.3s ease;
}

@keyframes slideInDown {
    from {
        transform: translateY(-20px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

.order-summary {
    background-color: #f8f9fa;
    padding: 1rem;
    border-radius: 0.375rem;
    margin-top: 1rem;
}

#discount-row {
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}
</style>

<!-- Include promotion JavaScript -->
<script src="{% load static %}{% static 'js/promotion.js' %}"></script>